
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>St√§rke Merge Battle 3D ‚Äì Prototyp</title>
  <style>
    html, body { margin: 0; padding: 0; overflow: hidden; background: #111; color: #fff; }
    canvas { width: 100%; height: 100%; display: block; }
    #ui { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.7); padding: 10px; border-radius: 5px; }
  </style>
</head>
<body>
  <div id="ui">üßç Spielerst√§rke: <span id="playerLevel">1</span></div>
  <canvas id="renderCanvas"></canvas>
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script>
    const canvas = document.getElementById("renderCanvas");
    const engine = new BABYLON.Engine(canvas, true);
    const playerLevelDisplay = document.getElementById("playerLevel");

    const gridSize = 10;
    const tileSize = 2;
    let playerLevel = 1;
    let playerMesh;
    const enemyMeshes = [];

    const createScene = function () {
      const scene = new BABYLON.Scene(engine);
      const camera = new BABYLON.ArcRotateCamera("camera1", -Math.PI / 2, Math.PI / 2.5, 25, new BABYLON.Vector3(10, 0, 10), scene);
      camera.attachControl(canvas, true);

      const light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);

      const groundMat = new BABYLON.StandardMaterial("groundMat", scene);
      groundMat.diffuseColor = new BABYLON.Color3(0.2, 0.2, 0.2);

      // Grid Boden
      for (let x = 0; x < gridSize; x++) {
        for (let z = 0; z < gridSize; z++) {
          const tile = BABYLON.MeshBuilder.CreateBox(`tile_${x}_${z}`, { size: tileSize, height: 0.1 }, scene);
          tile.position.x = x * tileSize;
          tile.position.z = z * tileSize;
          tile.position.y = -0.05;
          tile.material = groundMat;
        }
      }

      // Spieler
      playerMesh = BABYLON.MeshBuilder.CreateBox("player", { size: 1 }, scene);
      playerMesh.position.set(tileSize * 1, 0.5, tileSize * 1);

      // Gegner
      const enemyPositions = [
        { x: 4, z: 1, level: 1 },
        { x: 6, z: 2, level: 2 },
        { x: 8, z: 3, level: 3 }
      ];

      enemyPositions.forEach((pos, i) => {
        const enemy = BABYLON.MeshBuilder.CreateSphere("enemy" + i, { diameter: 1.2 }, scene);
        enemy.position.set(tileSize * pos.x, 0.6, tileSize * pos.z);
        enemy.metadata = { level: pos.level, alive: true };

        enemy.actionManager = new BABYLON.ActionManager(scene);
        enemy.actionManager.registerAction(new BABYLON.ExecuteCodeAction(BABYLON.ActionManager.OnPickTrigger, function () {
          if (!enemy.metadata.alive) return;
          if (playerLevel >= enemy.metadata.level) {
            playerLevel += enemy.metadata.level;
            playerLevelDisplay.textContent = playerLevel;
            enemy.metadata.alive = false;
            enemy.dispose();
          } else {
            playerLevel = 1;
            playerLevelDisplay.textContent = playerLevel;
            playerMesh.position.set(tileSize * 1, 0.5, tileSize * 1);
          }
        }));
        enemyMeshes.push(enemy);
      });

      return scene;
    };

    const scene = createScene();
    engine.runRenderLoop(() => scene.render());
    window.addEventListener("resize", () => engine.resize());
  </script>
</body>
</html>
